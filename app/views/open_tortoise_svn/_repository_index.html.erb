<% javascript_tag do %>
    // Current version of redmine uses Rails 2.3.x, so we can use prototype.js.
    var gOpenTortoiseSvn = {
        root_url: "<%= escape_javascript(@repository.url) %>",
      <%- if (@path) -%>
        repository_url: "<%= escape_javascript(@repository.url.gsub(/\/$/, '') + '/' + @path) %>",
      <%- else -%>
        repository_url: "<%= escape_javascript(@repository.url) %>",
      <%- end -%>
        svn_image_path: "<%= escape_javascript(image_path('svn_icon.png', :plugin => 'redmine_open_tortoise_svn')) %>",
        valid: true
    };
<% end %>

<% case(params[:action])
   when "show" %>
    <%= javascript_include_tag("open_tortoise_svn_show", :plugin => "redmine_open_tortoise_svn") %>
<% when "changes" %>
    <%= javascript_include_tag("open_tortoise_svn_show", :plugin => "redmine_open_tortoise_svn") %>
<% end %>
